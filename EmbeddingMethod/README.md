# Introduce
This directory contains the source of Embedding Method which converts AQPs into low-dimentional vectors based NLP methods and calculates the Euclidean distance from QEP.
- **code/**
  - **process_AQP_list/**
    - **json2AQP.py** converts the collection of AQPs generated by ARENA system to JSON format.
    - **merge_json.py** merge multiple JSON files into one.
    - **input/** contains serveral AQPs collections for different queries in txt format.
    - **output/** contains serveral AQPs collections for different queries in JSON format.
  - **Preprocessing/**
    - **preprocess.py** trains skip-gram model.
    - **word2vec/** converts node to vector.
    - **input/** is AQPs corpus.
    - **output/** is node-vector dictionary.
  - **GenerateTreeNodeSet/**
    - **get_DFS_node_list.py** parses AQPs in JSON format and obtain DFS sequence of nodes.
    - **input/** AQPs in JSON format to be parsed.
    - **output/** is the time of get the node sequences.
  - **GenerateTreeVector/**
    - **generate_and_compare.py** generates all AQP Vectors for given query and calculates the Euclidean distance from QEP.
    - **sent2vec.py** converts AQP node sequence to AQP Vector.
    - **dictfile/** contains the node-vector dictionary generated by **Preprocessing**.
    - **output/** contains the time of get AQP Vectors and the top 50 farthest AQP ids from QEP.

# Install Requirements
install python 3.9.6

install redis 7.0.0
- `pip3 install -r requirements.txt`

# Run
1. Copy the collection of AQPs in txt format generated by ARENA system to **code/process_AQP_list/input/** and run **code/process_AQP_list/json2AQP.py** to generate the collection of AQPs in JSON format. It can be AQPs corpus or AQPs from given query. 
2. Copy AQPs corpus in JSON format to **code/Preprocessing/input/** and run **code/Preprocessing/preprocess.py** to generate the node-vector dictionary.
3. Copy AQPs from given query in JSON format to **code/GenerateTreeNodeSet/input/** and run **code/GenerateTreeNodeSet/get_DFS_node_list.py** to get all node sequences of AQPs for given query.
4. run **code/GenerateTreeVector/generate_and_compare.py** to get all AQP Vectors and calculate the Euclidean distance from QEP.